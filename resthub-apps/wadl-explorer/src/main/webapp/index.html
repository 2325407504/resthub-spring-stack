<!doctype html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 		
 		<!-- JQuery -->
		<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
 
 		<!-- JQuery-UI : les composants graphiques -->
		<script type="text/javascript" src="js/jquery-ui-1.8.custom.min.js"></script>
		<link type="text/css" href="css/smoothness/jquery-ui-1.8.custom.css" rel="Stylesheet" />		
 
 		<!-- Plugins customs -->
		<script type="text/javascript" src="js/jquery.wadlParser.js"></script>
		
		<style type="text/css">
			html {
				font-family: "Trebuchet MS",Verdana,sans-serif;
			}
			
			.results-wrapper { 
				width: 80%; 
				padding: 0.4em; 
			}
			.results-wrapper h3 { 
				cursor: pointer;
				margin: 0; 
				padding: 0.4em; 
				text-align: center; 
			}
			#results { 
				display: none;
				overflow: auto;  
				height: 300px; 
			}
			.resource {
				text-align:center;
			}
			.method {
				margin-top: 10px;
			}
		</style>
		
		<script type="text/javascript">
			
	        $(document).ready(function(){
				// Création des widgets jQueryUI
				constructUI();
                $("#RESTServiceForm").submit(function(event){
                    var dest = $("#RESTServiceDest").val();
                    // Fait un appel AJAX et stope l'événemnet.
                    getWADL(dest);
                    event.preventDefault();
                });			
			});

			/**
			 * Construits les widgets de la page avec JQueryUI.
			 */
			function constructUI() {
				// Rend le panneau de résultat pliable/dépliable.
				$("#resultPanel h3").click(function() {
					$("#results").slideToggle();
				});
			} // constructUI().
			
            /**
             * Lance un appel AJAX pour récupérer le WADL du site.
             */
            function getWADL(dest){
                if (dest) {
	                $.get(dest, null, 
						// Traitement du résultat
						function(xml, status, xhr){
							if (status != "success") {
								alert("L'url '" + dest + "' n'est pas accessible !");
							} else {
								var path = dest.substring(0, 
										dest.lastIndexOf("/"));
		                        // Affiche le résultat en text dans un panneau de
								// debug.
								$("#results").text(xhr.responseText);
								// Construit les formulaire de consultation.
								$(xml).wadlParse({
										result:$("#wadlParseResults"),
										rootPath: path
								});	
							}
	                    });
                } else {
                    alert("L'url est vide !");
                }
            }
        </script>
    </head>
    <body>
        <form id="RESTServiceForm">
            <label>
                Url du site testé : 
            </label>
            <input id="RESTServiceDest" type="text"/><input value="Tester" type="submit"/>
        </form>
		<div id="resultPanel" class="results-wrapper ui-widget-content ui-corner-all">
			<h3 class="ui-widget-header ui-corner-all">WADL</h3>
			<pre id="results">Aucun WADL chargé</pre>
		</div>
			
		<div id="wadlParseResults"></div>
		
    </body>
</html>
